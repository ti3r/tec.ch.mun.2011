#{extends 'main.html' /}
#{set title:'Home' /}

<div>
	<div style="text-align: left; padding-left: 25px;">
		<a href="http://tec-ch-mun-2011.herokuapp.com/application/mensajes" 
		class="twitter-share-button" 
		data-url="http://tec-ch-mun-2011.herokuapp.com/mesajes/mensajes" 
		data-text="&{'mensajes.tweet'}"
		data-count="none">Tweet</a>
		<span class="fb-like" data-href="http://tec-ch-mun-2011.herokuapp.com/application/mensajes" 
					data-send="true" data-width="400" data-show-faces="false" data-font="verdana"></span>
		#{if session.username}
		<span>
		<img src="/public/images/plus_icon.gif" style="cursor:pointer;" onclick="showDialog();" />
		<span style="font-size: 12px;">&{'mensajes.agregarMensaje'}</span>
		</span>
		#{/if}
	</div>
<hr style="width: 95%" />
#{ifnot mensajes}
	&{'mensajes.noMensajes'}
#{/ifnot}
#{list items:mensajes, as:'mensaje'}
	<div id="mensaje_box">
		<span>${mensaje.mensaje}</span>
		#{if mensaje.autor}
			<div>
				<span>&{'mensage.autor'}:</span>
				<span>${mensage.autor.nombre}</span>
			</div>
		#{/if} 
	</div>
#{/list}

#{if session.username}
	<div id="publica_mensaje" class="modal_dialog">
	<p>Publicar un Mensaje</p>
	#{form @Application.publicarMensaje()}
		<table>
		<tr>
			<td valign="top">
				<input type="hidden" id="mensaje.autor.nombre" name="mensaje.autor.nombre" 
				value="${session.username}" />
				<label for="mensaje.mensaje">&{'mensajes.mensaje'}</label>
			</td>
		</tr>
		<tr>
			<td>
				<textarea id="mensaje.mensaje" name="mensaje.mensaje" cols="20" rows="5"></textarea>
			</td>
		</tr>
		<tr>
			<td colspan="2">
			<input type="submit" id="submit" onclick="return valEmptyMsg();" name="submit" value="&{'submit'}" />
			<input type="reset" id="reset" name="reset" value="&{'reset'}" />
			</td>
		</tr>
		</table>
	#{/form}
	</div>
	<script type="text/javascript">
		$('#publica_mensaje').modialog();
		
		function showDialog(){
			$('#publica_mensaje').modialog('open');
		}
		function valEmtpyMsg(){
			alert('Alog aqui que pedo');
			$('#mensaje.mensaje').val('Hola Mundo');
			return false;
		}
		
	</script>
#{/if}
</div>